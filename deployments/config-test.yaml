# LLMProxy 本地 Docker 测试配置
# 测试所有新配置功能：admin, auth.builtin, usage.builtin, rate_limit.redis

server:
  listen: ":8000"
  read_timeout: 30s
  idle_timeout: 120s

log:
  level: debug
  format: json
  output: stdout

# 存储配置（Docker 环境使用服务名）
storage:
  caches:
    - name: default
      enabled: true
      driver: redis
      addr: redis:6379
      password: ""
      db: 0
      pool_size: 10

# 后端服务（使用 httpbin 作为测试后端）
backends:
  - name: httpbin
    url: "https://httpbin.org"
    weight: 1

# Admin API 配置
admin:
  enabled: true
  token: "test-admin-token"
  listen: ""
  db_path: "/home/llmproxy/data/keys.db"

# 鉴权配置（测试 builtin 类型）
auth:
  enabled: true
  mode: first_match
  header_names:
    - Authorization
    - X-API-Key
  skip_paths:
    - /health
    - /metrics
    - /admin
  pipeline:
    - name: builtin_auth
      type: builtin
      enabled: true

# 路由配置
routing:
  enabled: true
  load_balance: round_robin
  timeout: 30s
  retry:
    enabled: true
    max_retries: 2

# 限流配置（使用 Redis）
rate_limit:
  enabled: true
  storage: redis
  redis: default
  global:
    enabled: true
    requests_per_second: 100
    burst_size: 200
  per_key:
    enabled: false

# 健康检查
health_check:
  enabled: false

# 指标
metrics:
  enabled: true
  path: /metrics

# 用量上报（测试 builtin 类型）
usage:
  enabled: true
  reporters:
    - name: local
      type: builtin
      enabled: true
      builtin:
        retention_days: 7
